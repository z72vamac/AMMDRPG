\section{Strengthening the formulation of \AMD}\label{bounds}
\noindent
In this section we present some valid inequalities for \AMD\xspace that reinforce the formulation given in Section \ref{Form}. Moreover, the \eqref{DCW} constraint has products of binary and continuous variables that, when they are linearized, produce big-M constants that have to be tightened. This section also provides some bounds for these constants whenever it is possible. 

%\CV{*** This last sentence is not done yet -JUSTO dixit- ***}

%Notation here is not very good: we use C for clusters, centroids and the drone endurance. This must be improved.

\subsection{Valid inequalities for the \AMD}
\noindent
In this problem, we assume that the fleet has more than one drone since otherwise the problem reduces to (AMDRPG) that was already studied in \cite{art:Amorosi2021}. Therefore, if there exists a stage in which more than one drone is launched, the mothership does not need to perform $|\mathcal G|$ different stages. Hence, most likely the model does not need to deal with those stages that are numbered at the end. By exploiting this idea, it is possible to concentrate all drone operations on the first stages, avoiding empty tasks in $\mathcal T$.
\noindent
Let $\beta^t$ be a binary variable that assumes the value one if all the target graphs are visited when the operation $t$ begins, and  zero, otherwise. Note that, if all the operations are completed before the stage $t$ then they are also completed before the stage $t+1$. Hence, $\beta$ variables must satisfy the following constraints:

\begin{equation}\tag{Monotonicity}\label{eq:Monotonicity}
\beta^t \leq \beta^{t+1}, \mbox{ for all } t=1,\ldots, |\mathcal{G}|-1.
\end{equation}

\noindent
Let $k^t$ denote the number of graphs that are visited in the stage $t$. This number can be computed using the $u$ variables since $u^{e_gtd}$ takes the value 1 if the graph $g$ is visited in stage $t$ by the drone $d$. Thus:

$$k^t=\sum_{e_g\in g:g\in\mathcal G}\sum_{d\in\mathcal D} u^{e_gtd}.$$

\noindent
Hence, if $\beta^t$ equals one, the entire set of graphs in $\mathcal G$ must have been visited before the stage $t$:

\begin{equation}\tag{VI-1}\label{eq:VI-1}
\sum_{t'=1}^{t-1} k^{t'} \geq |\mathcal G|\beta^t,
\end{equation}
where $|\mathcal G|$ denotes the number of graphs of $\mathcal G$.

\noindent
To reduce the space of feasible solutions, we can assume without loss of generality that it is not permitted to have a stage $t$ without any operation if some graphs are still to be visited. This can be enforced by the following constraints:

\begin{equation}\tag{VI-2}\label{eq:VI-2}
k^t \geq 1 - \beta^t.
\end{equation}

\noindent
In addition, it is also possible to reduce the symmetry. Since we are assuming that drones are indistinguishable, we can assume that given an arbitrary order on them, we always assign drones to operations in that given order. This assumption allows us to assign for an operation at the stage $t$ the first drone that is available, avoiding to consider the last ones, if they are not necessary. This consideration can be implemented by means of the following set of inequalities. For all $t\in\mathcal T$:
\medskip

% \noindent **** OJO :  Mas fuertes ************
\begin{equation}\tag{VI-3}\label{eq:VI-3}
\sum_{e_g\in \mathcal G} u^{e_gtd} \leq \sum_{e_g:g\in\mathcal G}u^{e_gtd-1}, \; \forall d=2,\ldots |\mathcal D|,      
\end{equation}
\begin{equation}\tag{VI-4}\label{eq:VI-4}
\sum_{e_g\in \mathcal G} v^{e_gtd} \leq \sum_{e_g:g\in\mathcal G}v^{e_gtd-1}, \; \forall d=2,\ldots |\mathcal D|.      
\end{equation}
% ****************************
% \CV{\begin{equation}\tag{VI-3}\label{eq:VI-3}
% u^{e_gtd_1} \leq \sum_{e_g:g\in\mathcal G}\sum_{t\in\mathcal T} u^{e_gtd_2},\quad d_1>d_2
% \end{equation}
% \begin{equation}\tag{VI-4}\label{eq:VI-4}
% v^{e_gtd_1} \leq \sum_{e_g:g\in\mathcal G}\sum_{t\in\mathcal T} v^{e_gtd_2},\quad d_1>d_2.
% \end{equation}

\noindent
Hence, if the drone $d_1$ is assigned to the task $t$, every drone $d_2$ that is, for the launching order in $\mathcal D$, before than $d_1$, must have been also assigned to perform the task $t$.
\medskip
% }

\noindent
The model that we have proposed includes big-M constants. We have defined different big-M constants along this work. In order to strengthen the formulations we provide tight upper and lower bounds for those constants. In this section we present some results that adjust them for each one of the models.

\subsubsection*{Big $M$ constants bounding the distance from the launching / rendezvous point on the path followed by the mothership to the rendezvous / launching point on the target graph $g\in \mathcal{G}$}

%\CV{Maybe BigM can be more adjusted taking into account the endurance of the drone\ldots}
% \begin{itemize}
% \item \underline{\AMD}. 
\noindent
To linearize the first term of the objective function in \AMD, we define the auxiliar non-negative continuous variables $p_L^{e_gtd}$ (resp. $p_R^{e_gtd}$) and we model the product by including the following constraints:
\begin{align*}
p_L^{e_gtd} & \geq m_L^{e_g} u^{e_gtd}, \\
p_L^{e_gtd} & \leq d_L^{e_g} - M_L^{e_gtd}(1-u^{e_gt}).
\end{align*}
The best upper bound $M_L^{e_gtd}$ or $M_R^{e_gtd}$ that we can consider is the full diameter of the data, that is the maximum distance between every pair of vertices of the graphs $g\in \mathcal{G}$, in the input data, i.e., every launching or rendezvous point is inside the circle whose diametrically opposite points are described below. 
$$
M_R^{e_gtd} = \max_{\{v\in V_g, v'\in V_{g'} : g, g'\in\mathcal G\}} \|v - v'\| = M_L^{e_gtd}.
$$
\noindent
On the other hand, the minimum distance in this case can be zero. This bound is attainable whenever the launching or the rendezvous points of the mothership is the same that the rendezvous or launching point on the target graph $g\in \mathcal{G}$.

% \item \underline{\NMD}. In this case, the best upper bounds for $M_R^{e_gt}$ or $M_L^{e_gt}$ is the maximum distance between the polygonal chain $\mathcal{P}$ or the graph $\mathcal{N}$ and any of the target graphs $g\in \mathcal{G}$:
% $$
% M_R^{e_gt} = \max_{\{v\in V_g, w\in \mathcal N\}}\|v - w\| = M_L^{i_gt}.
% $$
% On the other hand, the minimum distance can be computed by taking the closest points between the graph $g$ and the network $\mathcal{N}$:
% $$
% m_R^{e_gt} = \min_{\{v\in V_g, w\in \mathcal N\}}\|v - w\| = m_L^{e_gt}.
% $$
% \end{itemize}

% \subsubsection*{Bounds on the big $M$ constants for the distance from the launching point to the rendezvous points for the MTZ/SEC formulations in \AMD}

% We can compute a tighter upper bound for the distance $d_{RL}^{gg'}$ between each pair of graphs $g,g'$ for the constraints obtained by the linearization of its product:
% \begin{align*}
% p^{gg'} & \geq m_{RL}^{gg'} d_{RL}^{gg'}, \\
% p^{gg'} & \leq d_{RL}^{gg'} - M_{RL}^{gg'}(1-w^{gg'}).
% \end{align*}
% This upper bound $M_{RL}^{gg'}$ is given by the diameter of $g\cup g'$:
% $$
% M_{RL}^{gg'} = \max_{\{v\in V_g, v'\in V_{g'}\}}\|v - v'\|.
% $$


\subsubsection*{Bounds on the big $M$ constants for the distance from the launching to the rendezvous points on the target graph $g\in \mathcal{G}$.} 
\noindent
When the drone visits a graph $g$, it has to go from one edge $e_g$ to another edge $e'_g$ depending on the order given by $z^{e_ge_g'}$. This fact produces a product of variables linearized by the following constraints:
\begin{align*}
p^{e_ge'_g} & \geq m^{e_ge_g'} d_{RL}^{gg'}, \\
p^{e_ge_g'} & \leq d^{e_ge_g'} - M^{e_ge_g'}(1-z^{e_ge_g'}).
\end{align*}

\noindent
Since we are taking into account the distance between two edges $e=(B^{e_g},C^{e_g}), \, e'=(B^{e^\prime_g},C^{e^\prime_g})\in E_g$, the maximum and minimum distances between their vertices give us the upper and lower bounds:
\begin{align*}
M^{e_g e^\prime_g} = & \max\{\|B^{e_g} - C^{e^\prime_g}\|, \|B^{e_g} - B^{e^\prime_g}\|, \|C^{e_g} - B^{e^\prime_g}\|, \|C^{e_g} - C^{j_g}\|\}, \\
m^{e_g e^\prime_g} = & \min\{\|B^{e_g} - C^{e^\prime_g}\|, \|B^{e_g} - B^{e^\prime_g}\|, \|C^{e_g} - B^{e^\prime_g}\|, \|C^{e_g} - C^{e^\prime_g}\|\}.
\end{align*}

% \subsubsection*{Bounds on the big $M$ constants for the distance covered by the mothership on the polygonal for the \PMD \ model during one drone operation.}
% In the case of \PMD, we can also set tighter upper bounds for the distance covered by the drone inside the polygonal during an operation that starts in $e$ and finishes at $e'$ (or vice versa) (see \eqref{pol:dLRt} and \eqref{pol:dRLt}). This is clearly bounded from above by the total length of the line segments where the mothership is located. 
% \begin{equation*}
% M_{LR}^{ee't} = M_{RL}^{ee't} = \left\{\begin{matrix}
% \mathcal L(e), & \text{if } e = e',\\ 
% \displaystyle \sum_{e<e''<e'}\mathcal L(e'') & \text{if } e < e', \\
% \displaystyle \sum_{e'<e''<e}\mathcal L(e'') & \text{if } e > e'.
% \end{matrix}\right.
% \end{equation*}


\subsubsection*{Bounds on the big $M$ constants for the distance covered by the drone during an operation for all the models by stages}
\noindent
To link the drone operation with the trip followed by the mothership, we have defined the constraint $\eqref{DCW}$ that includes another big-M constant:
\begin{equation*}
\left(\sum_{e_g\in E_g} u^{e_gtd}d_L^{e_gtd} + \sum_{e_g, e^\prime_g\in E_g}z^{e_ge^\prime_g}d^{e_ge^\prime_g} + \sum_{e_g\in E_g} \mu^{e_g}d^{e_g} + \sum_{e_g\in E_g} v^{e_gtd}d_R^{e_gtd}\right)/v_D \leq d_{RL}^t/v_M + M(1 - \sum_{e_g\in E_g} u^{e_gtd}).
\end{equation*}
\noindent
To obtain an upper bound on $M$ we add to the length of the graph $\mathcal L(g)$ the big-Ms computed for $u^{e_gtd}$ and $v^{e_gtd}$, namely $M_{L}^{e_gtd}$ and $M_R^{e_gtd}$, respectively, and the maximum distance that can be traveled by the drone to move from one edge to another one. This results in a valid value for this $M$ constant:

$$M = \mathcal{L}(g) + M_L^{e_gtd} + M_R^{e_gtd} + \sum_{e_g, e_g'\in E_g}M^{e_ge_g'}.$$

